<div class="bg-white shadow-xl rounded-lg overflow-hidden h-full flex flex-col">
  <div class="bg-blue-700 text-white p-4">
    <h2 class="text-xl font-bold">Chat with Maxwell's Resume</h2>
    <p class="text-blue-100 text-sm">Evaluate Maxwell's qualifications and fit for your open positions.</p>
  </div>
  
  <div class="p-4 flex-grow flex flex-col overflow-hidden">
    <div id="chat-messages" class="space-y-4 mb-4 flex-grow overflow-y-auto">
      <div class="bg-blue-50 p-3 rounded-lg">
        <p class="font-medium text-blue-800">AI Assistant</p>
        <p>Hello! I'm Maxwell's AI assistant. I can help evaluate his fit for your open positions based on his experience in technical leadership, product strategy, and global team management. Ask me how his skills align with specific roles at your organization.</p>
      </div>
    </div>

    <!-- Suggested Questions Section -->
    <div class="mb-4 flex-shrink-0">
      <p class="text-sm font-medium text-gray-700 mb-2">Suggested Questions:</p>
      <div class="space-y-2">
        <button type="button" class="suggested-question text-left w-full px-3 py-2 text-sm bg-gray-50 hover:bg-gray-100 text-gray-700 rounded-md transition-colors">Why would Maxwell be an excellent fit for a Development Manager role?</button>
        <button type="button" class="suggested-question text-left w-full px-3 py-2 text-sm bg-gray-50 hover:bg-gray-100 text-gray-700 rounded-md transition-colors">How do Maxwell's technical leadership skills translate to Engineering Director positions?</button>
        <button type="button" class="suggested-question text-left w-full px-3 py-2 text-sm bg-gray-50 hover:bg-gray-100 text-gray-700 rounded-md transition-colors">What experience does Maxwell have with managing global technical teams?</button>
        <button type="button" class="suggested-question text-left w-full px-3 py-2 text-sm bg-gray-50 hover:bg-gray-100 text-gray-700 rounded-md transition-colors">How would Maxwell's product strategy background benefit our organization?</button>
      </div>
    </div>
    
    <div class="border-t pt-3 flex-shrink-0">
      <form id="chat-form" class="flex items-end gap-2">
        <div class="flex-grow">
          <label for="question" class="block text-sm font-medium text-gray-700 mb-1">Your Question</label>
          <textarea id="question" name="question" rows="2" class="shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md resize-none" placeholder="Ask how Maxwell would be a good fit for a specific role..."></textarea>
        </div>
        <button type="submit" class="inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
          Send
        </button>
      </form>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const form = document.getElementById('chat-form');
  const messagesContainer = document.getElementById('chat-messages');
  const questionInput = document.getElementById('question');
  const suggestedQuestions = document.querySelectorAll('.suggested-question');
  
  // Add event listeners to suggested questions
  suggestedQuestions.forEach(button => {
    button.addEventListener('click', function() {
      questionInput.value = this.textContent;
      questionInput.focus();
    });
  });
  
  form.addEventListener('submit', function(e) {
    e.preventDefault();
    
    const question = questionInput.value.trim();
    if (!question) return;
    
    // Add user message to chat
    addMessage('You', question, 'bg-gray-100');
    
    // Show loading indicator
    const loadingId = addMessage('AI Assistant', 'Thinking...', 'bg-blue-50');
    
    // Send request to server
    fetch('/chat/message', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'X-CSRF-Token': document.querySelector('meta[name="csrf-token"]').content
      },
      body: JSON.stringify({ question: question })
    })
    .then(response => response.json())
    .then(data => {
      // Replace loading message with response
      removeMessage(loadingId);
      addMessage('AI Assistant', data.response, 'bg-blue-50');
    })
    .catch(error => {
      console.error('Error:', error);
      removeMessage(loadingId);
      addMessage('AI Assistant', 'Sorry, I encountered an error processing your request.', 'bg-red-50');
    });
    
    // Clear input
    questionInput.value = '';
  });
  
  function addMessage(sender, content, bgClass) {
    const messageId = 'msg-' + Date.now();
    const messageDiv = document.createElement('div');
    messageDiv.id = messageId;
    messageDiv.className = `${bgClass} p-3 rounded-lg`;
    messageDiv.innerHTML = `
      <p class="font-medium text-gray-800">${sender}</p>
      <p>${content}</p>
    `;
    messagesContainer.appendChild(messageDiv);
    
    // Scroll to bottom
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
    
    return messageId;
  }
  
  function removeMessage(messageId) {
    const message = document.getElementById(messageId);
    if (message) {
      message.remove();
    }
  }
});
</script> 